<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Tutorial</title>
<link rel="stylesheet" href="../../../../../doc/html/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.73.2">
<link rel="start" href="../index.html" title="The Boost Constrained Value library">
<link rel="up" href="../index.html" title="The Boost Constrained Value library">
<link rel="prev" href="introduction.html" title="Introduction">
<link rel="next" href="examples.html" title="Examples">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../boost.png"></td>
<td align="center"><a href="../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="introduction.html"><img src="../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="examples.html"><img src="../../../../../doc/html/images/next.png" alt="Next"></a>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="constrained_value.tutorial"></a><a class="link" href="tutorial.html" title="Tutorial">Tutorial</a>
</h2></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="tutorial.html#constrained_value.tutorial.simple_constrained_objects">Simple
      constrained objects</a></span></dt>
<dt><span class="section"><a href="tutorial.html#constrained_value.tutorial.changing_constraints_at_runtime">Changing
      constraints at runtime</a></span></dt>
<dt><span class="section"><a href="tutorial.html#constrained_value.tutorial.custom_error_policies">Custom
      error policies</a></span></dt>
<dt><span class="section"><a href="tutorial.html#constrained_value.tutorial.bounded_objects">Bounded objects</a></span></dt>
<dt><span class="section"><a href="tutorial.html#constrained_value.tutorial.bounded_objects_with_open_ranges">Bounded
      objects with open ranges</a></span></dt>
<dt><span class="section"><a href="tutorial.html#constrained_value.tutorial.compile_time_fixed_bounds">Compile-time
      fixed bounds</a></span></dt>
<dt><span class="section"><a href="tutorial.html#constrained_value.tutorial.other_error_policies_for_bounded_objects">Other
      error policies for bounded objects</a></span></dt>
<dt><span class="section"><a href="tutorial.html#constrained_value.tutorial.using_constrained_objects_in_debug_mode_only">Using
      constrained objects in debug mode only</a></span></dt>
</dl></div>
<p>
      This section is a step-by-step introduction to the functionality of the library.
      For more advanced examples of how the library can be used, see <a class="link" href="examples.html" title="Examples">Examples</a>
      section.
    </p>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="constrained_value.tutorial.simple_constrained_objects"></a><a class="link" href="tutorial.html#constrained_value.tutorial.simple_constrained_objects" title="Simple constrained objects">Simple
      constrained objects</a>
</h3></div></div></div>
<p>
        </p>
<p>
          The first step to use a <a class="link" href="introduction.html#constrained_object_def">constrained
          object</a> is to define a constraint, which is simply a <a href="http://www.sgi.com/tech/stl/Predicate.html" target="_top">predicate</a>.
          For instance, if you want to have an object which always represents an
          even integer number, you can define the predicate like this:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">struct</span> <span class="identifier">is_even</span> <span class="special">{</span>
    <span class="keyword">bool</span> <span class="keyword">operator</span> <span class="special">()</span> <span class="special">(</span><span class="keyword">int</span> <span class="identifier">i</span><span class="special">)</span> <span class="keyword">const</span>
    <span class="special">{</span> <span class="keyword">return</span> <span class="special">(</span><span class="identifier">i</span> <span class="special">%</span> <span class="number">2</span><span class="special">)</span> <span class="special">==</span> <span class="number">0</span><span class="special">;</span> <span class="special">}</span>
<span class="special">};</span></pre>
<p>
        </p>
<p>
        </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../../../doc/html/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
            If the constraint is specified as a function object type like in this
            example, the invocation operator must be a <code class="computeroutput"><span class="keyword">const</span></code>
            member function.
          </p></td></tr>
</table></div>
<p>
        </p>
<p>
          Now you can create an object which is a wrapper for <code class="computeroutput"><span class="keyword">int</span></code>
          and can have only an even value:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span> <span class="identifier">is_even</span><span class="special">&gt;</span> <span class="identifier">even_int</span><span class="special">;</span>
<span class="identifier">even_int</span> <span class="identifier">i</span><span class="special">;</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          Once a constrained object is created, it can be used in almost the same
          way as the underlying value type object. All the mutating (and stream extraction/insertion)
          operators are overloaded, so you can write:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">i</span> <span class="special">=</span> <span class="number">4</span><span class="special">;</span>
<span class="identifier">i</span> <span class="special">+=</span> <span class="number">2</span><span class="special">;</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          However, the crucial difference between <code class="computeroutput"><span class="identifier">even_int</span></code>
          and <code class="computeroutput"><span class="keyword">int</span></code> is that the former
          will not let being assigned any odd value. In case of an attempt to assign
          such value it will use its error policy which, by default, throws an exception
          of <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1broken__constraint.html" target="_top">broken_constraint</a></code>
          class:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">i</span> <span class="special">=</span> <span class="number">1</span><span class="special">;</span> <span class="comment">// exception!</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          In the example above, the assignment is <span class="bold"><strong>not</strong></span>
          performed and exception is thrown instead.
        </p>
<p>
        </p>
<p>
          The same applies to initialization of constrained objects with invalid
          values:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">even_int</span> <span class="identifier">a</span><span class="special">;</span> <span class="comment">// OK
</span><span class="identifier">even_int</span> <span class="identifier">b</span><span class="special">(</span><span class="number">2</span><span class="special">);</span> <span class="comment">// OK
</span><span class="identifier">even_int</span> <span class="identifier">c</span><span class="special">(</span><span class="number">3</span><span class="special">);</span> <span class="comment">// exception!</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          In the first example, <code class="computeroutput"><span class="identifier">a</span></code>
          is default-constructed which means the underlying value is value-initialized
          (so for <code class="computeroutput"><span class="keyword">int</span></code> it will have the
          value of <code class="computeroutput"><span class="number">0</span></code>).
        </p>
<p>
        </p>
<div class="tip"><table border="0" summary="Tip">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="../../../../../doc/html/images/tip.png"></td>
<th align="left">Tip</th>
</tr>
<tr><td align="left" valign="top"><p>
            <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>
            objects are implicitly convertible to and from the underlying value type,
            making them easily interchangeable.
          </p></td></tr>
</table></div>
<p>
        </p>
<p>
          For example, the statements below employ implicit conversion from <code class="computeroutput"><span class="identifier">even_int</span></code> to <code class="computeroutput"><span class="keyword">int</span></code>:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">int</span> <span class="identifier">x</span> <span class="special">=</span> <span class="identifier">i</span><span class="special">;</span> <span class="comment">// initializes x with the underlying value of i
</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">abs</span><span class="special">(</span><span class="identifier">i</span><span class="special">);</span> <span class="comment">// calls std::abs(int)</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          The implicit conversion is convenient, but there are some situations when
          it won't work. In such cases you can extract the value explicitly using
          the <code class="computeroutput"><span class="identifier">value</span><span class="special">()</span></code>
          member function:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="comment">// std::max(2, i); // won't compile: template parameter is ambiguous (int or even_int?)
</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">max</span><span class="special">(</span><span class="number">2</span><span class="special">,</span> <span class="identifier">i</span><span class="special">.</span><span class="identifier">value</span><span class="special">());</span> <span class="comment">// OK: template parameter is int</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          Constrained objects can be read from and written into streams just like
          objects of the underlying value type.
        </p>
<p>
        </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../../../../doc/html/images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top"><p>
            Stream extraction/insertion operators for <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>
            read/write the underlying value only, not the whole constrained object
            with its constraint and error policy.
          </p></td></tr>
</table></div>
<p>
        </p>
<p>
          Examples of using a constrained object with streams (assuming the "classic"
          locale is used) are shown below:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">std</span><span class="special">::</span><span class="identifier">stringstream</span> <span class="identifier">stream</span><span class="special">;</span>

<span class="identifier">i</span> <span class="special">=</span> <span class="number">10</span><span class="special">;</span>
<span class="identifier">stream</span> <span class="special">&lt;&lt;</span> <span class="identifier">i</span><span class="special">;</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">stream</span><span class="special">.</span><span class="identifier">str</span><span class="special">()</span> <span class="special">==</span> <span class="string">"10"</span> <span class="special">);</span>

<span class="identifier">stream</span><span class="special">.</span><span class="identifier">str</span><span class="special">(</span><span class="string">"12 13"</span><span class="special">);</span>
<span class="identifier">stream</span> <span class="special">&gt;&gt;</span> <span class="identifier">i</span><span class="special">;</span> <span class="comment">// OK: 12 is even
</span><span class="identifier">assert</span><span class="special">(</span> <span class="identifier">i</span> <span class="special">==</span> <span class="number">12</span> <span class="special">);</span>
<span class="identifier">stream</span> <span class="special">&gt;&gt;</span> <span class="identifier">i</span><span class="special">;</span> <span class="comment">// exception: 13 is not even, i is not changed</span></pre>
<p>
        </p>
<p>
      </p>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="constrained_value.tutorial.changing_constraints_at_runtime"></a><a class="link" href="tutorial.html#constrained_value.tutorial.changing_constraints_at_runtime" title="Changing constraints at runtime">Changing
      constraints at runtime</a>
</h3></div></div></div>
<p>
        </p>
<p>
          Sometimes it may be useful to be able to change constraint of a constrained
          object at run-time. This is possible if a callback type (such as function
          pointer type or <code class="computeroutput"><a href="../../../../function/index.html" target="_top">boost::function</a></code>)
          is used as the constraint type. By default, <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>
          class template uses the latter if constraint type is not specified, so
          any type of constraint can be used:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;</span> <span class="identifier">c</span><span class="special">(</span><span class="number">2</span><span class="special">,</span> <span class="identifier">is_even</span><span class="special">());</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          In the line above, we define a constrained object <code class="computeroutput"><span class="identifier">c</span></code>
          which initially has an object of previously defined <code class="computeroutput"><span class="identifier">is_even</span></code>
          class as its constraint.
        </p>
<p>
        </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../../../../doc/html/images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top"><p>
            Note, that when a callback type is used as the type of constraint, the
            constraint must always be initialized properly when constructing a <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>
            object because it is invoked during the construction. Error policy may
            also be invoked if <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>
            object is initialized with an invalid value -- in such case it must be
            initialized properly too.
          </p></td></tr>
</table></div>
<p>
        </p>
<p>
          Once we have a constrained object with dynamic constraint policy, we can
          change the constraint using <code class="computeroutput"><a href="../reference/constrained__functions_8hpp.html" target="_top">change_constraint</a><span class="special">()</span></code> function:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">struct</span> <span class="identifier">is_positive</span>
<span class="special">{</span>
    <span class="keyword">bool</span> <span class="keyword">operator</span> <span class="special">()</span> <span class="special">(</span><span class="keyword">int</span> <span class="identifier">i</span><span class="special">)</span> <span class="keyword">const</span>
    <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">i</span> <span class="special">&gt;</span> <span class="number">0</span><span class="special">;</span> <span class="special">}</span>
<span class="special">};</span>

<a href="../reference/constrained__functions_8hpp.html" target="_top">change_constraint</a><span class="special">(</span><span class="identifier">c</span><span class="special">,</span> <span class="identifier">is_positive</span><span class="special">());</span>
</pre>
<p>
        </p>
<p>
        </p>
<p>
          From now on, <code class="computeroutput"><span class="identifier">c</span></code> will accept
          only positive values (previous <code class="computeroutput"><span class="identifier">is_even</span></code>
          constraint is not used anymore).
        </p>
<p>
        </p>
<p>
          The constraint can be of any kind of callable object accepted by <code class="computeroutput"><a href="../../../../function/index.html" target="_top">boost::function</a></code>. For
          instance, it may be a function pointer, as in the example below:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">bool</span> <span class="identifier">is_positive_fn</span><span class="special">(</span><span class="keyword">int</span> <span class="identifier">i</span><span class="special">)</span>
<span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">i</span> <span class="special">&gt;</span> <span class="number">0</span><span class="special">;</span>
<span class="special">}</span>

<a href="../reference/constrained__functions_8hpp.html" target="_top">change_constraint</a><span class="special">(</span><span class="identifier">c</span><span class="special">,</span> <span class="special">&amp;</span><span class="identifier">is_positive_fn</span><span class="special">);</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          <a href="../../../../lambda/index.html" target="_top">Lambda expressions</a> can
          be used too, so any of the two examples above can be rewritten as:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">using</span> <a href="../../../../lambda/index.html" target="_top">boost::lambda::_1</a><span class="special">;</span>

<a href="../reference/constrained__functions_8hpp.html" target="_top">change_constraint</a><span class="special">(</span><span class="identifier">c</span><span class="special">,</span> <span class="identifier">_1</span> <span class="special">&gt;</span> <span class="number">0</span><span class="special">);</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          Trying to change the constraint if the current value of a constrained object
          does not meet the new constraint will cause the error policy to be called:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;</span> <span class="identifier">c</span><span class="special">(-</span><span class="number">2</span><span class="special">,</span> <span class="identifier">is_even</span><span class="special">());</span>
<a href="../reference/constrained__functions_8hpp.html" target="_top">change_constraint</a><span class="special">(</span><span class="identifier">c</span><span class="special">,</span> <span class="identifier">is_positive</span><span class="special">());</span> <span class="comment">// exception: -2 is not positive!</span></pre>
<p>
        </p>
<p>
        </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../../../doc/html/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
            Constraint of a constrained object cannot be accessed directly for modification,
            because the underlying value could become invalid according to the modified
            constraint. Therefore the constraint of a <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>
            object is immutable and <code class="computeroutput"><a href="../reference/constrained__functions_8hpp.html" target="_top">change_constraint</a><span class="special">()</span></code> function has to be used in order to
            modify the constraint. The function actually constructs a new object
            with the new constraint but the old value and error handler, and if this
            succeeds, swaps the old object with the new object.
          </p></td></tr>
</table></div>
<p>
      </p>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="constrained_value.tutorial.custom_error_policies"></a><a class="link" href="tutorial.html#constrained_value.tutorial.custom_error_policies" title="Custom error policies">Custom
      error policies</a>
</h3></div></div></div>
<p>
        </p>
<p>
          By default, constrained objects use <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1throw__exception.html" target="_top">throw_exception</a><span class="special">&lt;</span><a href="../reference/structboost_1_1constrained__value_1_1broken__constraint.html" target="_top">broken_constraint</a><span class="special">&gt;</span></code> template class as their error policy.
          All it does is using <code class="computeroutput"><a href="../../../../exception/doc/BOOST_THROW_EXCEPTION.html" target="_top">BOOST_THROW_EXCEPTION</a></code>
          macro with object of the specified type (here, <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1broken__constraint.html" target="_top">broken_constraint</a></code>)
          as the argument.
        </p>
<p>
        </p>
<p>
          The default type of exceptions thrown can be changed, as in the example
          below:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">struct</span> <span class="identifier">my_exception</span> <span class="special">:</span> <span class="keyword">public</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">exception</span> <span class="special">{</span> <span class="special">};</span> <span class="comment">// must derive from std::exception
</span>
<a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span> <span class="identifier">is_even</span><span class="special">,</span> <a href="../reference/structboost_1_1constrained__value_1_1throw__exception.html" target="_top">throw_exception</a><span class="special">&lt;</span><span class="identifier">my_exception</span><span class="special">&gt;</span> <span class="special">&gt;</span> <span class="identifier">c</span><span class="special">;</span>
<span class="identifier">c</span> <span class="special">=</span> <span class="number">1</span><span class="special">;</span> <span class="comment">// throws my_exception()</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          You can also change the behavior of <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>
          objects by defining your own error policy. When an invalid value is assigned,
          <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>
          object does not actually assign it but calls its error policy instead.
          Error policy is a callable object with a signature like in the example
          below:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">struct</span> <span class="identifier">ignore</span>
<span class="special">{</span>
    <span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">typename</span> <span class="identifier">V</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">C</span><span class="special">&gt;</span>
    <span class="keyword">void</span> <span class="keyword">operator</span> <span class="special">()</span> <span class="special">(</span><span class="identifier">V</span> <span class="special">&amp;</span> <span class="identifier">value</span><span class="special">,</span> <span class="keyword">const</span> <span class="identifier">V</span> <span class="special">&amp;</span> <span class="identifier">new_value</span><span class="special">,</span> <span class="identifier">C</span> <span class="special">&amp;</span> <span class="identifier">constraint</span><span class="special">)</span> <span class="keyword">const</span>
    <span class="special">{</span>
        <span class="keyword">if</span><span class="special">(</span> <span class="special">!</span><span class="identifier">constraint</span><span class="special">(</span><span class="identifier">value</span><span class="special">)</span> <span class="special">)</span>
            <span class="keyword">throw</span> <a href="../reference/structboost_1_1constrained__value_1_1broken__constraint.html" target="_top">broken_constraint</a><span class="special">();</span>
    <span class="special">}</span>
<span class="special">};</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          The policy defined above simply ignores any assignment of invalid value
          (given as the second argument), leaving the current underlying value (the
          first argument) unchanged.
        </p>
<p>
        </p>
<p>
          Note, that error policy cannot be just an empty function -- it is obliged
          to either leave <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>
          object in a valid state if it returns (by properly modifying the underlying
          value or the constraint) or not to return at all (e.g., by throwing an
          exception). Therefore, when a <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>
          object is constructed with an invalid value, the policy cannot simply ignore
          the operation (this would allow for construction of invalid objects). This
          special case is handled in the body of the invocation operator: an exception
          is thrown, preventing construction of invalid <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>
          object.
        </p>
<p>
        </p>
<p>
          The effects of using <code class="computeroutput"><span class="identifier">ignore</span></code>
          policy are presented below:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span> <span class="identifier">is_even</span><span class="special">,</span> <span class="identifier">ignore</span><span class="special">&gt;</span> <span class="identifier">ignoring_even_int</span><span class="special">;</span>
<span class="identifier">ignoring_even_int</span> <span class="identifier">i</span><span class="special">(</span><span class="number">2</span><span class="special">);</span>

<span class="identifier">i</span> <span class="special">=</span> <span class="number">4</span><span class="special">;</span> <span class="comment">// OK
</span><span class="special">++</span><span class="identifier">i</span><span class="special">;</span> <span class="comment">// error -- operation ignored (and no exception thrown)
</span><span class="identifier">assert</span><span class="special">(</span> <span class="identifier">i</span> <span class="special">==</span> <span class="number">4</span> <span class="special">);</span>
<span class="identifier">i</span> <span class="special">+=</span> <span class="number">2</span><span class="special">;</span> <span class="comment">// OK
</span><span class="identifier">assert</span><span class="special">(</span> <span class="identifier">i</span> <span class="special">==</span> <span class="number">6</span> <span class="special">);</span>

<span class="identifier">ignoring_even_int</span> <span class="identifier">j</span><span class="special">(</span><span class="number">1</span><span class="special">);</span> <span class="comment">// exception! (cannot ignore construction with invalid value)</span></pre>
<p>
        </p>
<p>
      </p>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="constrained_value.tutorial.bounded_objects"></a><a class="link" href="tutorial.html#constrained_value.tutorial.bounded_objects" title="Bounded objects">Bounded objects</a>
</h3></div></div></div>
<p>
        </p>
<p>
          A very common case of constrained objects are <a class="link" href="introduction.html#bounded_object_def">bounded
          objects</a>. To simplify their creation, the library contains <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1within__bounds.html" target="_top">within_bounds</a></code>
          predicate and the alias of <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>
          called <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1bounded.html" target="_top">bounded</a></code>,
          which employs this predicate as the constraint. It can be used as follows:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <a href="../reference/structboost_1_1constrained__value_1_1bounded.html" target="_top">bounded</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;::</span><span class="identifier">type</span> <span class="identifier">bint</span><span class="special">;</span>
<span class="identifier">bint</span> <span class="identifier">i</span><span class="special">;</span></pre>
<p>
        </p>
<p>
        </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../../../doc/html/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
            Note the <code class="computeroutput"><span class="special">::</span><span class="identifier">type</span></code>
            after the template class name -- this library uses nested typedef technique
            for template aliases, since there are no true template aliases in C++
            (yet).
          </p></td></tr>
</table></div>
<p>
        </p>
<p>
          Bounded object <code class="computeroutput"><span class="identifier">i</span></code> has default-initialized
          bounds. The bounds can be changed using suitable functions:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><a href="../reference/bounded__functions_8hpp.html" target="_top">change_lower_bound</a><span class="special">(</span><span class="identifier">i</span><span class="special">,</span> <span class="special">-</span><span class="number">5</span><span class="special">);</span>
<a href="../reference/bounded__functions_8hpp.html" target="_top">change_upper_bound</a><span class="special">(</span><span class="identifier">i</span><span class="special">,</span> <span class="number">5</span><span class="special">);</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          Both the bounds can be changed at one time as well:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><a href="../reference/bounded__functions_8hpp.html" target="_top">change_bounds</a><span class="special">(</span><span class="identifier">i</span><span class="special">,</span> <span class="special">-</span><span class="number">5</span><span class="special">,</span> <span class="number">5</span><span class="special">);</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          The abovementioned functions simply call <code class="computeroutput"><a href="../reference/constrained__functions_8hpp.html" target="_top">change_constraint</a><span class="special">()</span></code> with appropriate arguments.
        </p>
<p>
        </p>
<p>
          The bounds can also be set during construction of a bounded object:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">bint</span> <span class="identifier">i</span><span class="special">(</span><span class="identifier">bint</span><span class="special">::</span><span class="identifier">constraint_type</span><span class="special">(-</span><span class="number">5</span><span class="special">,</span> <span class="number">5</span><span class="special">));</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          In all cases the effect is the same: <code class="computeroutput"><span class="identifier">i</span></code>
          can be assigned only a value that belongs to the [-5, 5] interval:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">i</span> <span class="special">=</span> <span class="number">5</span><span class="special">;</span>
<span class="special">++</span><span class="identifier">i</span><span class="special">;</span> <span class="comment">// exception!</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">i</span> <span class="special">=</span> <span class="special">-</span><span class="number">4</span><span class="special">;</span>
<span class="identifier">i</span> <span class="special">-=</span> <span class="number">2</span><span class="special">;</span> <span class="comment">// exception!</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          Current bounds' values can be read in the following way:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">assert</span><span class="special">(</span> <span class="identifier">i</span><span class="special">.</span><span class="identifier">constraint</span><span class="special">().</span><span class="identifier">lower_bound</span><span class="special">()</span> <span class="special">==</span> <span class="special">-</span><span class="number">5</span> <span class="special">);</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">i</span><span class="special">.</span><span class="identifier">constraint</span><span class="special">().</span><span class="identifier">upper_bound</span><span class="special">()</span> <span class="special">==</span> <span class="number">5</span> <span class="special">);</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          Trying to change the bounds so that the underlying value would be outside
          of the new bounds triggers the error policy:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">bint</span> <span class="identifier">j</span><span class="special">(-</span><span class="number">5</span><span class="special">,</span> <span class="identifier">bint</span><span class="special">::</span><span class="identifier">constraint_type</span><span class="special">(-</span><span class="number">10</span><span class="special">,</span> <span class="number">10</span><span class="special">));</span>
<a href="../reference/bounded__functions_8hpp.html" target="_top">change_lower_bound</a><span class="special">(</span><span class="identifier">j</span><span class="special">,</span> <span class="number">0</span><span class="special">);</span> <span class="comment">// exception: -5 is not in [0, 10]</span></pre>
<p>
        </p>
<p>
        </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../../../doc/html/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
            In order to use a type as the underlying type of a bounded object, a
            <a href="http://en.wikipedia.org/wiki/Strict_weak_ordering" target="_top">strict
            weak ordering</a> relation must be specified for it. By default,
            <code class="computeroutput"><span class="keyword">operator</span> <span class="special">&lt;</span>
            <span class="special">()</span></code> for the type is used, but this
            behavior can be customized by providing a comparison predicate as the
            one of <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1bounded.html" target="_top">bounded</a></code>
            template's parameters.
          </p></td></tr>
</table></div>
<p>
        </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="../../../../../doc/html/images/warning.png"></td>
<th align="left">Warning</th>
</tr>
<tr><td align="left" valign="top"><p>
            Built-in C++ floating point types should not be used to form bounded
            objects (see <a class="link" href="rationale.html#constrained_value.rationale.no_floats" title="Why C++'s floating point types shouldn't be used with bounded objects?">rationale</a>
            for explanation).
          </p></td></tr>
</table></div>
<p>
      </p>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="constrained_value.tutorial.bounded_objects_with_open_ranges"></a><a class="link" href="tutorial.html#constrained_value.tutorial.bounded_objects_with_open_ranges" title="Bounded objects with open ranges">Bounded
      objects with open ranges</a>
</h3></div></div></div>
<p>
        </p>
<p>
          By default, both the bounds are included in the allowed range and this
          trait cannot be changed at runtime. The behavior can be overridden by specifying
          explicitly the type of bounds exclusion.
        </p>
<p>
        </p>
<p>
          To be able to change bounds exclusion at runtime, define a bounded object
          as shown below (some of the parameters of <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1bounded.html" target="_top">bounded</a></code>,
          which were given default values in the previous example, need to be specified
          explicitly -- their meaning is explained in the comments):
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <a href="../../../../rational/index.html" target="_top">boost::rational</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;</span> <span class="identifier">rational</span><span class="special">;</span> <span class="comment">// helper typedef for brevity
</span>
<span class="keyword">typedef</span> <a href="../reference/structboost_1_1constrained__value_1_1bounded.html" target="_top">bounded</a><span class="special">&lt;</span>
    <span class="identifier">rational</span><span class="special">,</span> <span class="comment">// the underlying value type
</span>    <span class="identifier">rational</span><span class="special">,</span> <span class="comment">// type of the lower bound (by default same as value type)
</span>    <span class="identifier">rational</span><span class="special">,</span> <span class="comment">// type of the upper bound (by default same as lower bound type)
</span>    <a href="../reference/structboost_1_1constrained__value_1_1throw__exception.html" target="_top">throw_exception</a><span class="special">&lt;&gt;,</span> <span class="comment">// error policy (by default throw_exception&lt;&gt;)
</span>    <span class="keyword">bool</span><span class="special">,</span> <span class="comment">// lower bound exclusion indicator type (by default boost::mpl::false_)
</span>    <span class="keyword">bool</span>  <span class="comment">// upper bound exclusion indicator type (by default same as the lower one)
</span><span class="special">&gt;::</span><span class="identifier">type</span> <span class="identifier">bounded_rational</span><span class="special">;</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          When omitted, the bounds exclusion indicators default to <code class="computeroutput"><a href="../../../../mpl/doc/refmanual/bool.html" target="_top">boost::mpl::false_</a></code>.
          Objects of this type are empty and do not occupy space within a bounded
          object, they are also implicitly convertible to <code class="computeroutput"><span class="keyword">bool</span></code>
          yielding <code class="computeroutput"><span class="keyword">false</span></code> (the value
          means that the bounds are not excluded from the allowed range). However,
          to be able to change bounds exclusion at runtime, <code class="computeroutput"><span class="keyword">bool</span></code>
          type has to be used instead to allow for storing the state of bounds exclusion
          and change it.
        </p>
<p>
        </p>
<p>
          You can use objects of <code class="computeroutput"><span class="identifier">bounded_rational</span></code>
          type, defined above, in the following way:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">bounded_rational</span> <span class="identifier">r</span><span class="special">(</span><span class="identifier">bounded_rational</span><span class="special">::</span><span class="identifier">constraint_type</span><span class="special">(</span><span class="number">0</span><span class="special">,</span> <span class="number">1</span><span class="special">,</span> <span class="keyword">false</span><span class="special">,</span> <span class="keyword">true</span><span class="special">));</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          Currently, <code class="computeroutput"><span class="identifier">r</span></code> allows for
          values in the range [0, 1):
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">r</span> <span class="special">=</span> <span class="identifier">rational</span><span class="special">(</span><span class="number">99</span><span class="special">,</span> <span class="number">100</span><span class="special">);</span>
<span class="identifier">r</span> <span class="special">+=</span> <span class="identifier">rational</span><span class="special">(</span><span class="number">1</span><span class="special">,</span> <span class="number">100</span><span class="special">);</span> <span class="comment">// exception!</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          You can query and change the status of bounds inclusion in the following
          way:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">assert</span><span class="special">(</span> <span class="identifier">r</span><span class="special">.</span><span class="identifier">constraint</span><span class="special">().</span><span class="identifier">upper_bound_excluded</span><span class="special">()</span> <span class="special">==</span> <span class="keyword">true</span> <span class="special">);</span>
<a href="../reference/bounded__functions_8hpp.html" target="_top">change_upper_bound_exclusion</a><span class="special">(</span><span class="identifier">r</span><span class="special">,</span> <span class="keyword">false</span><span class="special">);</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          Now, both bounds are included in the allowed range, which is [0, 1]:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">r</span> <span class="special">=</span> <span class="identifier">rational</span><span class="special">(</span><span class="number">99</span><span class="special">,</span> <span class="number">100</span><span class="special">);</span>
<span class="identifier">r</span> <span class="special">+=</span> <span class="identifier">rational</span><span class="special">(</span><span class="number">1</span><span class="special">,</span> <span class="number">100</span><span class="special">);</span> <span class="comment">// OK</span></pre>
<p>
        </p>
<p>
      </p>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="constrained_value.tutorial.compile_time_fixed_bounds"></a><a class="link" href="tutorial.html#constrained_value.tutorial.compile_time_fixed_bounds" title="Compile-time fixed bounds">Compile-time
      fixed bounds</a>
</h3></div></div></div>
<p>
        </p>
<p>
          Values of bounds are often associated with a concept represented by some
          bounded objects and don't change. For instance, variables representing
          percentage of completion of some task often lay in the range [0, 100] and
          that range is fixed. An alias of <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1bounded.html" target="_top">bounded</a></code>
          called <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1bounded__int.html" target="_top">bounded_int</a></code>
          can be used to express such types easily:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <a href="../reference/structboost_1_1constrained__value_1_1bounded__int.html" target="_top">bounded_int</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span> <span class="number">0</span><span class="special">,</span> <span class="number">100</span><span class="special">&gt;::</span><span class="identifier">type</span> <span class="identifier">percent</span><span class="special">;</span>
<span class="identifier">percent</span> <span class="identifier">p</span><span class="special">;</span>

<span class="identifier">p</span> <span class="special">=</span> <span class="number">50</span><span class="special">;</span> <span class="comment">// OK
</span><span class="identifier">p</span> <span class="special">=</span> <span class="number">200</span><span class="special">;</span> <span class="comment">// exception!</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          In this case, the bounds have to be of the same type as the underlying
          value type and values of this type must be allowed to be used as non-type
          template arguments (so only integral types and some pointer types are allowed).
        </p>
<p>
        </p>
<p>
          Bounds are stored using <code class="computeroutput"><a href="../../../../mpl/doc/refmanual/integral-c.html" target="_top">boost::mpl::integral_c</a></code>,
          so they do not occupy any space in a bounded object and can't be changed
          at runtime. The bounds are compile-time constants and can be read in two
          ways:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">assert</span><span class="special">(</span> <span class="identifier">p</span><span class="special">.</span><span class="identifier">constraint</span><span class="special">().</span><span class="identifier">upper_bound</span><span class="special">()</span> <span class="special">==</span> <span class="number">100</span> <span class="special">);</span>
<a href="../../../../static_assert/index.html" target="_top">BOOST_STATIC_ASSERT</a><span class="special">(</span> <span class="identifier">percent</span><span class="special">::</span><span class="identifier">constraint_type</span><span class="special">::</span><span class="identifier">upper_type</span><span class="special">::</span><span class="identifier">value</span> <span class="special">==</span> <span class="number">100</span> <span class="special">);</span></pre>
<p>
        </p>
<p>
        </p>
<div class="caution"><table border="0" summary="Caution">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Caution]" src="../../../../../doc/html/images/caution.png"></td>
<th align="left">Caution</th>
</tr>
<tr><td align="left" valign="top"><p>
            Using <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1bounded__int.html" target="_top">bounded_int</a></code>
            (as any other type in this library) does not, by itself, protect from
            integer overflows (see <a class="link" href="rationale.html#constrained_value.rationale.overflows" title="Why bounded objects don't protect against arithmetic overflows?">rationale
            section</a> for discussion on this topic).
          </p></td></tr>
</table></div>
<p>
        </p>
<p>
          As mentioned before, <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1bounded__int.html" target="_top">bounded_int</a></code>
          can be used only for bounds that can be passed as template arguments. For
          other cases there is another method of creating bounded objects with bounds
          fixed at compile-time. The trick is to "convert" a value into
          a type, i.e. create a type that can be converted to the desired type yielding
          the value:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <a href="../../../../rational/index.html" target="_top">boost::rational</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;</span> <span class="identifier">rational</span><span class="special">;</span>

<span class="keyword">struct</span> <span class="identifier">quarter2type</span> <span class="comment">// returns 1/4
</span><span class="special">{</span>
    <span class="keyword">operator</span> <span class="identifier">rational</span> <span class="special">()</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">rational</span><span class="special">(</span><span class="number">1</span><span class="special">,</span> <span class="number">4</span><span class="special">);</span> <span class="special">}</span>
<span class="special">};</span>

<span class="keyword">struct</span> <span class="identifier">half2type</span> <span class="comment">// returns 1/2
</span><span class="special">{</span>
    <span class="keyword">operator</span> <span class="identifier">rational</span> <span class="special">()</span> <span class="keyword">const</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">rational</span><span class="special">(</span><span class="number">1</span><span class="special">,</span> <span class="number">2</span><span class="special">);</span> <span class="special">}</span>
<span class="special">};</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          Using the types above, we can create a bounded object that always represents
          a rational number from the range [1/4, 1/2]:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><a href="../reference/structboost_1_1constrained__value_1_1bounded.html" target="_top">bounded</a><span class="special">&lt;</span><span class="identifier">rational</span><span class="special">,</span> <span class="identifier">quarter2type</span><span class="special">,</span> <span class="identifier">half2type</span><span class="special">&gt;::</span><span class="identifier">type</span> <span class="identifier">my_rational</span><span class="special">(</span><span class="identifier">rational</span><span class="special">(</span><span class="number">1</span><span class="special">,</span> <span class="number">2</span><span class="special">));</span>
<span class="identifier">my_rational</span> <span class="special">=</span> <span class="identifier">rational</span><span class="special">(</span><span class="number">1</span><span class="special">,</span> <span class="number">3</span><span class="special">);</span> <span class="comment">// OK
</span><span class="identifier">my_rational</span> <span class="special">*=</span> <span class="number">2</span><span class="special">;</span> <span class="comment">// exception: 2/3 &gt; 1/2</span></pre>
<p>
        </p>
<p>
      </p>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="constrained_value.tutorial.other_error_policies_for_bounded_objects"></a><a class="link" href="tutorial.html#constrained_value.tutorial.other_error_policies_for_bounded_objects" title="Other error policies for bounded objects">Other
      error policies for bounded objects</a>
</h3></div></div></div>
<p>
        </p>
<p>
          The library includes <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1wrap.html" target="_top">wrap</a></code>
          error policy for bounded objects, which wraps out-of-bounds values over
          the bounds rather than throwing an exception. This allows for easy creation
          of objects that behave according to the modulo arithmetic. There are also
          two aliases of <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1bounded.html" target="_top">bounded</a></code>
          defined: <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1wrapping.html" target="_top">wrapping</a></code>
          and <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1wrapping__int.html" target="_top">wrapping_int</a></code>,
          which use this error policy. An example is presented below:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><a href="../reference/structboost_1_1constrained__value_1_1wrapping__int.html" target="_top">wrapping_int</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span> <span class="number">0</span><span class="special">,</span> <span class="number">359</span><span class="special">&gt;::</span><span class="identifier">type</span> <span class="identifier">angle</span> <span class="special">=</span> <span class="number">180</span><span class="special">;</span>

<span class="identifier">angle</span> <span class="special">+=</span> <span class="number">360</span><span class="special">;</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">angle</span> <span class="special">==</span> <span class="number">180</span> <span class="special">);</span>

<span class="identifier">angle</span> <span class="special">+=</span> <span class="number">180</span><span class="special">;</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">angle</span> <span class="special">==</span> <span class="number">0</span> <span class="special">);</span></pre>
<p>
        </p>
<p>
        </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../../../../doc/html/images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top"><p>
            <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1wrap.html" target="_top">wrap</a></code>
            error policy is suitable only for types representing integer numbers
            or random access iterators.
          </p></td></tr>
</table></div>
<p>
        </p>
<p>
          Another error policy for bounded objects is <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1clip.html" target="_top">clip</a></code>,
          which clips values to the bounds. There are also two aliases of <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1bounded.html" target="_top">bounded</a></code>
          defined for convenience: <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1clipping.html" target="_top">clipping</a></code>
          and <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1clipping__int.html" target="_top">clipping_int</a></code>.
          Below is an example of how the policy works:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><a href="../reference/structboost_1_1constrained__value_1_1clipping__int.html" target="_top">clipping_int</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span> <span class="number">0</span><span class="special">,</span> <span class="number">120</span><span class="special">&gt;::</span><span class="identifier">type</span> <span class="identifier">velocity</span><span class="special">;</span>

<span class="comment">// accelerating:
</span><span class="identifier">velocity</span> <span class="special">+=</span> <span class="number">50</span><span class="special">;</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">velocity</span> <span class="special">==</span> <span class="number">50</span> <span class="special">);</span>

<span class="comment">// accelerating more:
</span><span class="identifier">velocity</span> <span class="special">+=</span> <span class="number">100</span><span class="special">;</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">velocity</span> <span class="special">==</span> <span class="number">120</span> <span class="special">);</span> <span class="comment">// cannot go faster than this
</span>
<span class="comment">// decelerating:
</span><span class="identifier">velocity</span> <span class="special">-=</span> <span class="number">100</span><span class="special">;</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">velocity</span> <span class="special">==</span> <span class="number">20</span> <span class="special">);</span>

<span class="comment">// decelerating more:
</span><span class="identifier">velocity</span> <span class="special">-=</span> <span class="number">50</span><span class="special">;</span>
<span class="identifier">assert</span><span class="special">(</span> <span class="identifier">velocity</span> <span class="special">==</span> <span class="number">0</span> <span class="special">);</span> <span class="comment">// cannot go slower than this</span></pre>
<p>
        </p>
<p>
        </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../../../../doc/html/images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top"><p>
            When using <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1wrap.html" target="_top">wrap</a></code>
            or <code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1clip.html" target="_top">clip</a></code>
            error policy, the allowed range must always be valid (the upper bound
            cannot be less than the lower bound).
          </p></td></tr>
</table></div>
<p>
      </p>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="constrained_value.tutorial.using_constrained_objects_in_debug_mode_only"></a><a class="link" href="tutorial.html#constrained_value.tutorial.using_constrained_objects_in_debug_mode_only" title="Using constrained objects in debug mode only">Using
      constrained objects in debug mode only</a>
</h3></div></div></div>
<p>
        </p>
<p>
          Constrained objects can be used as a debugging tool to verify that a program
          operates only on an assumed subset of possible values. However, it is usually
          desirable to check the assumptions only in debug mode and avoid the checks
          in release code for performance reasons. The most straightforward approach
          to this problem would be to use a compile-time switch to turn the constraint-checking
          on in debug mode and off in release mode:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="preprocessor">#ifndef</span> <span class="identifier">NDEBUG</span>
<span class="keyword">typedef</span> <a href="../reference/structboost_1_1constrained__value_1_1bounded__int.html" target="_top">bounded_int</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span> <span class="number">0</span><span class="special">,</span> <span class="number">100</span><span class="special">&gt;::</span><span class="identifier">type</span> <span class="identifier">my_int</span><span class="special">;</span>
<span class="preprocessor">#else</span>
<span class="keyword">typedef</span> <span class="keyword">int</span> <span class="identifier">my_int</span><span class="special">;</span>
<span class="preprocessor">#endif</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          However, the interface of <code class="computeroutput"><span class="identifier">my_int</span></code>
          would be different in debug mode (when it would be a specialization of
          <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>)
          and in release mode (when it would be the built-in <code class="computeroutput"><span class="keyword">int</span></code>
          type). This could lead to problems like in the example below:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">my_int</span> <span class="identifier">x</span> <span class="special">=</span> <span class="number">4</span><span class="special">;</span>
<span class="identifier">my_int</span> <span class="identifier">y</span> <span class="special">=</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">max</span><span class="special">(</span><span class="identifier">x</span><span class="special">.</span><span class="identifier">value</span><span class="special">(),</span> <span class="number">2</span><span class="special">);</span>
</pre>
<p>
        </p>
<p>
        </p>
<p>
          Here, <code class="computeroutput"><span class="identifier">my_int</span></code> couldn't be
          defined as <code class="computeroutput"><span class="keyword">int</span></code>, because it
          doesn't have <code class="computeroutput"><span class="identifier">value</span><span class="special">()</span></code>
          member function. On the other hand, this member function has to be called
          when <code class="computeroutput"><span class="identifier">my_int</span></code> is <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>,
          because the implicit conversion will not work for arguments of template
          functions like <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">max</span><span class="special">()</span></code>.
        </p>
<p>
        </p>
<p>
          To avoid this problem, the library defines an alias of <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>
          called <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1unconstrained.html" target="_top">unconstrained</a></code>.
          It uses a dummy constraint (<code class="computeroutput"><a href="../reference/structboost_1_1constrained__value_1_1no__constraint.html" target="_top">no_constraint</a></code>)
          returning <code class="computeroutput"><span class="keyword">true</span></code> for any value,
          and thus does not impose any constraint on the assigned values. Therefore,
          the definition of <code class="computeroutput"><span class="identifier">my_int</span></code>
          may look like this:
        </p>
<p>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="preprocessor">#ifndef</span> <span class="identifier">NDEBUG</span>
<span class="keyword">typedef</span> <a href="../reference/structboost_1_1constrained__value_1_1bounded__int.html" target="_top">bounded_int</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span> <span class="number">0</span><span class="special">,</span> <span class="number">100</span><span class="special">&gt;::</span><span class="identifier">type</span> <span class="identifier">my_int</span><span class="special">;</span>
<span class="preprocessor">#else</span>
<span class="keyword">typedef</span> <a href="../reference/classboost_1_1constrained__value_1_1unconstrained.html" target="_top">unconstrained</a><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;::</span><span class="identifier">type</span> <span class="identifier">my_int</span><span class="special">;</span>
<span class="preprocessor">#endif</span></pre>
<p>
        </p>
<p>
        </p>
<p>
          Types created using <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1unconstrained.html" target="_top">unconstrained</a></code>
          template provide the interface of <code class="computeroutput"><a href="../reference/classboost_1_1constrained__value_1_1constrained.html" target="_top">constrained</a></code>,
          but turn the constraint-checking off permanently. The implementation is
          optimized to allow a good compiler to generate code that is virtually as
          efficient as if using the bare underlying type.
        </p>
<p>
      </p>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright  2004 -2008 Robert Kawulak (Robert.Kawulak.at.gmail.com)<p>
        Distributed under the Boost Software License, Version 1.0 (see accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>).
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="introduction.html"><img src="../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="examples.html"><img src="../../../../../doc/html/images/next.png" alt="Next"></a>
</div>
</body>
</html>
